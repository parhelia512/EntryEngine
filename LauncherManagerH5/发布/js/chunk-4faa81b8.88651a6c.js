(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4faa81b8"],{"0748":function(e,t,o){"use strict";var n=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("table",{staticClass:"table"},[o("thead",[o("tr",{attrs:{align:"left"}},[e.choose?o("th"):e._e(),e._l(e.thead,(function(t,n){return o("th",{key:"thead-"+n,style:e.theadStyle?e.theadStyle[n]:null,on:{click:function(t){return t.stopPropagation(),e.clickTile(n)}}},[e._v(" "+e._s(t)+" ")])}))],2)]),o("tbody",e._l(e.list,(function(t,n){return o("tr",{key:"tbody-"+n,attrs:{align:"left",valign:"top"},on:{click:function(o){return o.stopPropagation(),e.clickRow(t)}}},[e.choose?o("td",{staticStyle:{padding:"0"},on:{click:function(e){e.stopPropagation()}}},[o("van-checkbox",{staticStyle:{"justify-content":"center",padding:"10px 5px"},on:{click:function(t){return t.stopPropagation(),e.onChoose(n)}},model:{value:e.chooseValues[n],callback:function(t){e.$set(e.chooseValues,n,t)},expression:"chooseValues[index]"}})],1):e._e(),e._l(e.tbody,(function(n,i){return o("td",{key:"tbody-td-"+i,style:e.tbodyStyle?e.tbodyStyle[i]:null,domProps:{innerHTML:e._s(t[n])}})}))],2)})),0)])},i=[],s=(o("caad"),o("a9e3"),o("d3b7"),{name:"ComponentName",components:{},props:{list:Array,option:Object,choose:{type:Number,default:0,validator:function(e){return[0,1,2].includes(e)}},theadStyle:Object,tbodyStyle:Object},data:function(){return{chooseValues:[],chooseList:[],nextChoose:null}},computed:{thead:function(){var e=[];for(var t in this.option)e.push(t);return e},tbody:function(){var e=[];for(var t in this.option)e.push(this.option[t]);return e}},watch:{list:{handler:function(e){console.log("table",e)},deep:!0}},methods:{clickRow:function(e){this.$emit("clickRow",e)},onChoose:function(e){for(var t in console.log("点击选择",e,this.chooseValues),1==this.choose&&(console.log("单选",this.nextChoose),this.nextChoose!=e&&(null!=this.nextChoose&&(this.chooseValues[this.nextChoose]=!1),this.nextChoose=e)),this.chooseList=[],this.chooseValues)this.chooseValues[t]&&this.chooseList.push(t);this.$emit("chooseClick",this.chooseList),this.$forceUpdate()},initChooseValues:function(){var e=[];if(this.choose&&this.list.length)for(var t=0;t<this.list.length;t++,e.push(!1));this.chooseValues=e},clearChoose:function(){if(this.choose&&this.list.length)for(var e=0;e<this.list.length;e++)this.chooseValues[e]=!1;this.chooseList=[],this.$forceUpdate()},verifyChoose:function(e){var t=this;return new Promise((function(o,n){t.chooseList.length?o():(t.$Toast(e||"请选择数据"),n())}))},clickTile:function(e){this.$emit("clickTile",e)}},mounted:function(){this.initChooseValues(),console.log("props---\x3e",this.$props)}}),a=s,c=(o("7efd"),o("2877")),r=Object(c["a"])(a,n,i,!1,null,"38358d1b",null);t["a"]=r.exports},"11da":function(e,t,o){},"129f":function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e===1/t:e!=e&&t!=t}},1802:function(e,t,o){"use strict";o.r(t);var n=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"container"},[o("van-pull-refresh",{on:{refresh:function(t){return e.getServers(!0)}},model:{value:e.isLoading,callback:function(t){e.isLoading=t},expression:"isLoading"}},[o("Table",{ref:"table",attrs:{list:e.filterServices,option:{"名称":"newName","服务版本":"info","状态":"state"},theadStyle:{1:"cursor: pointer"},tbodyStyle:{0:"cursor: pointer",1:"cursor: pointer",2:"cursor: pointer"},choose:2,rowPointer:!0},on:{chooseClick:e.chooseClick,clickTile:e.clickTile,clickRow:e.clickRow}})],1),o("van-dialog",{attrs:{title:e.dialog.title,"before-close":e.dialogClose,"show-cancel-button":""},model:{value:e.dialog.show,callback:function(t){e.$set(e.dialog,"show",t)},expression:"dialog.show"}},[o("van-form",{ref:"from",attrs:{"validate-trigger":"onSubmit"},on:{submit:e.onSubmit}},[o("van-field",{attrs:{name:"Name",label:"名称",rules:[{required:!0,message:"请填写名称"}]},model:{value:e.from.Name,callback:function(t){e.$set(e.from,"Name",t)},expression:"from.Name"}}),o("input-select",{attrs:{name:"Server",label:"服务器",rules:[{required:!0,message:"请选择服务器"}],inputType:1,list:e.list,listKey:"NickName",bindKey:"ID"},model:{value:e.from.Server,callback:function(t){e.$set(e.from,"Server",t)},expression:"from.Server"}}),o("input-select",{attrs:{name:"ServerType",label:"服务类型",rules:[{required:!0,message:"请选择服务类型"}],inputType:1,list:e.serverTypeList,listKey:"Name"},model:{value:e.from.ServerType,callback:function(t){e.$set(e.from,"ServerType",t)},expression:"from.ServerType"}}),o("van-field",{attrs:{name:"LaunchCommand",label:"启动命令",type:"textarea",rows:"10"},model:{value:e.from.LaunchCommand,callback:function(t){e.$set(e.from,"LaunchCommand",t)},expression:"from.LaunchCommand"}})],1)],1),o("van-dialog",{attrs:{title:"修改","before-close":e.changeClose,"show-cancel-button":""},model:{value:e.changeShow,callback:function(t){e.changeShow=t},expression:"changeShow"}},[o("van-cell-group",[o("van-cell",{attrs:{title:"名称","title-style":"max-width: 5em;margin-right: 12px;color: #969799;","value-class":"change-service-label"}},[e._l(e.chooseListNewName,(function(t,n){return o("p",{key:"change-service-"+n,staticStyle:{padding:"0",margin:"0"}},[e._v(" "+e._s(t)+" ")])}))],2)],1),o("van-form",{ref:"changeFrom",attrs:{"validate-trigger":"onSubmit","label-width":"5em"},on:{submit:e.onSubmitChange}},[o("van-field",{attrs:{name:"LaunchCommand",label:"启动命令",type:"textarea",rows:"10",placeholder:"输入命令",rules:[{required:!0,message:"请输入命令"}]},model:{value:e.changeFrom.LaunchCommand,callback:function(t){e.$set(e.changeFrom,"LaunchCommand",t)},expression:"changeFrom.LaunchCommand"}})],1)],1),o("Command",{attrs:{show:e.commandShow,chooseList:e.chooseList},on:{close:function(t){e.commandShow=!1},submit:function(t){return e.getServers(!0)}}}),o("FloatBtn",{attrs:{list:["更新","停止","启动","命令","添加","修改","删除"]},on:{choose:e.chooseFloatBtn}}),o("van-action-sheet",{attrs:{actions:e.actionsList},on:{select:e.onSelect},model:{value:e.actionsShow,callback:function(t){e.actionsShow=t},expression:"actionsShow"}}),o("Nav")],1)},i=[],s=(o("99af"),o("a623"),o("4de4"),o("b0c0"),o("b85c")),a=o("216c"),c=o("9c02"),r=o("0748"),l=o("c017"),u=o("f4c2"),h=o("66ca"),f={name:"Services",components:{Nav:a["a"],FloatBtn:c["a"],Table:r["a"],InputSelect:u["a"],Command:l["a"]},data:function(){return{list:[],services:[],isLoading:!1,dialog:{title:"添加",show:!1,type:"add"},from:{Name:"",Server:"",ServerType:"",LaunchCommand:""},serverTypeList:[],chooseList:[],chooseListNewName:[],chooseListIndex:[],commandShow:!1,changeShow:!1,changeFrom:{LaunchCommand:""},actionsShow:!1,actionsList:[{name:"全部"}],chooseType:""}},computed:{filterServices:function(){var e=this,t=this.services.filter((function(t){return t.Type==e.chooseType||"全部"==e.chooseType}));return t}},methods:{getServers:function(e){var t=this;this.$IMBSProxy.GetServers((function(o){for(var n in console.log("list",o),e&&(t.isLoading=!1,t.services=[],t.actionsList=[]),o)o[n].NickName=o[n].NickName?o[n].NickName:o[n].EndPoint;t.list=o;var i,a=Object(s["a"])(o);try{for(a.s();!(i=a.n()).done;){var c=i.value;for(var r in c.Services){var l=c.Services[r];c.Services[r].newName="".concat(l.Name," (").concat(c.NickName,")"),c.Services[r].info="".concat(l.Type,' <span style="color:').concat(l.Revision==l.RevisionOnServer?"green":"red",'">(').concat(l.Revision," / ").concat(l.RevisionOnServer,")</span>");var u={0:{name:"停止",color:"red"},1:{name:"启动中",color:"orange"},2:{name:"运行",color:"green"}};c.Services[r].state='<span style="color:'.concat(u[l.Status].color,'">').concat(u[l.Status].name,"</span>")}t.services=t.services.concat(c.Services),console.log("=====>",t.services)}}catch(h){a.e(h)}finally{a.f()}}))},chooseFloatBtn:function(e){var t=this;switch(console.log("chooseFloatBtn",e),e){case 0:this.$refs.table.verifyChoose().then((function(){t.$IMBSProxy.UpdateService(t.chooseList,(function(e){e&&t.$Toast("更新成功")}))})).catch((function(){}));break;case 1:this.$refs.table.verifyChoose().then((function(){t.$Dialog.confirm({message:"是否停止所选服务"}).then((function(){t.$IMBSProxy.StopService(t.chooseList,(function(e){e&&t.$Toast("停止成功")}))})).catch((function(){}))})).catch((function(){}));break;case 2:this.$refs.table.verifyChoose().then((function(){t.$IMBSProxy.LaunchService(t.chooseList,(function(e){e&&t.$Toast("启动成功")}))})).catch((function(){}));break;case 3:this.$refs.table.verifyChoose().then((function(){return t.commandShow=!0})).catch((function(){}));break;case 4:this.from=JSON.parse(JSON.stringify(this.$options.data().from)),this.dialog.show=!0;break;case 5:this.$refs.table.verifyChoose().then((function(){t.changeFrom=JSON.parse(JSON.stringify(t.$options.data().changeFrom));var e,o=[],n=Object(s["a"])(t.chooseListIndex);try{for(n.s();!(e=n.n()).done;){var i=e.value;o.push(t.filterServices[i])}}catch(c){n.e(c)}finally{n.f()}var a=o.every((function(e){return e.LaunchCommand==o[0].LaunchCommand}));a&&(t.changeFrom.LaunchCommand=o[0].LaunchCommand),t.changeShow=!0})).catch((function(){}));break;case 6:this.$refs.table.verifyChoose().then((function(){t.$Dialog.confirm({message:"是否确定删除"}).then((function(){t.$IMBSProxy.DeleteService(t.chooseList,(function(e){e&&(t.$Toast("删除成功"),t.getServers(!0))}))})).catch((function(){}))})).catch((function(){}));break;default:break}},onSubmit:function(){var e=this;console.log("submit",this.from),this.$IMBSProxy.NewService(this.from.Server,this.from.ServerType,this.from.Name,this.from.LaunchCommand,(function(t){t&&(e.$Toast(e.dialog.title+"成功"),e.dialog.show=!1,e.getServers(!0))}))},dialogClose:function(e,t){"confirm"==e?(this.$refs.from.submit(),t(!1)):t()},onSubmitChange:function(){var e=this;console.log("onSubmitChange",this.changeFrom),this.$IMBSProxy.SetServiceLaunchCommand(this.chooseList,this.changeFrom.LaunchCommand,(function(t){t&&(e.$Toast("操作成功"),e.changeShow=!1,e.getServers(!0))}))},changeClose:function(e,t){"confirm"==e?(this.$refs.changeFrom.submit(),t(!1)):t()},getServiceType:function(){var e=this;this.$IMBSProxy.GetServiceType((function(t){e.serverTypeList=t;var o,n=Object(s["a"])(t);try{for(n.s();!(o=n.n()).done;){var i=o.value;e.actionsList.push({name:i.Name})}}catch(a){n.e(a)}finally{n.f()}e.setChooseTypeColor()}))},chooseClick:function(e){console.log("chooseClick",e),this.chooseListIndex=e,this.chooseList=[],this.chooseListNewName=[];var t,o=Object(s["a"])(e);try{for(o.s();!(t=o.n()).done;){var n=t.value;this.chooseList.push(this.filterServices[n].Name),this.chooseListNewName.push(this.filterServices[n].newName)}}catch(i){o.e(i)}finally{o.f()}},clickTile:function(e){console.log("clickTile",e),1==e&&(this.actionsShow=!0)},onSelect:function(e){console.log("onSelect",e),h["a"].serviceTypeSet(e.name),this.chooseType=e.name,this.setChooseTypeColor(),this.actionsShow=!1},setChooseTypeColor:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.chooseType;for(var t in console.log("setChooseTypeColor---\x3e",e),this.actionsList)this.actionsList[t].name==e?this.actionsList[t].color="#1989fa":this.actionsList[t].color=void 0},clickRow:function(e){console.log("clickRow----\x3e",e.Name),this.$router.push({path:"/serviceLog",query:{name:e.Name}})}},mounted:function(){this.getServers(),this.getServiceType(),this.chooseType=h["a"].serviceTypeGet()?h["a"].serviceTypeGet():"全部"}},d=f,m=(o("9cef"),o("2877")),v=Object(m["a"])(d,n,i,!1,null,"5110086d",null);t["default"]=v.exports},"216c":function(e,t,o){"use strict";var n=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("van-tabbar",{attrs:{route:""}},[o("van-tabbar-item",{attrs:{replace:"",to:"/home",icon:"desktop-o"}},[e._v(" 服务器 ")]),o("van-tabbar-item",{attrs:{replace:"",to:"/services",icon:"bars"}},[e._v(" 服务 ")]),o("van-tabbar-item",{attrs:{replace:"",to:"/mine",icon:"contact"}},[e._v(" 我的 ")])],1)},i=[],s={name:"Nav",components:{},props:{},data:function(){return{}},computed:{},watch:{},methods:{},mounted:function(){}},a=s,c=o("2877"),r=Object(c["a"])(a,n,i,!1,null,"2293e435",null);t["a"]=r.exports},3013:function(e,t,o){},"6abb":function(e,t,o){},"7efd":function(e,t,o){"use strict";var n=o("6abb"),i=o.n(n);i.a},"841c":function(e,t,o){"use strict";var n=o("d784"),i=o("825a"),s=o("1d80"),a=o("129f"),c=o("14c3");n("search",1,(function(e,t,o){return[function(t){var o=s(this),n=void 0==t?void 0:t[e];return void 0!==n?n.call(t,o):new RegExp(t)[e](String(o))},function(e){var n=o(t,e,this);if(n.done)return n.value;var s=i(e),r=String(this),l=s.lastIndex;a(l,0)||(s.lastIndex=0);var u=c(s,r);return a(s.lastIndex,l)||(s.lastIndex=l),null===u?-1:u.index}]}))},"99af":function(e,t,o){"use strict";var n=o("23e7"),i=o("d039"),s=o("e8b5"),a=o("861d"),c=o("7b0b"),r=o("50c4"),l=o("8418"),u=o("65f0"),h=o("1dde"),f=o("b622"),d=o("2d00"),m=f("isConcatSpreadable"),v=9007199254740991,p="Maximum allowed index exceeded",y=d>=51||!i((function(){var e=[];return e[m]=!1,e.concat()[0]!==e})),g=h("concat"),b=function(e){if(!a(e))return!1;var t=e[m];return void 0!==t?!!t:s(e)},S=!y||!g;n({target:"Array",proto:!0,forced:S},{concat:function(e){var t,o,n,i,s,a=c(this),h=u(a,0),f=0;for(t=-1,n=arguments.length;t<n;t++)if(s=-1===t?a:arguments[t],b(s)){if(i=r(s.length),f+i>v)throw TypeError(p);for(o=0;o<i;o++,f++)o in s&&l(h,f,s[o])}else{if(f>=v)throw TypeError(p);l(h,f++,s)}return h.length=f,h}})},"9cef":function(e,t,o){"use strict";var n=o("3013"),i=o.n(n);i.a},a623:function(e,t,o){"use strict";var n=o("23e7"),i=o("b727").every,s=o("a640"),a=o("ae40"),c=s("every"),r=a("every");n({target:"Array",proto:!0,forced:!c||!r},{every:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},caad:function(e,t,o){"use strict";var n=o("23e7"),i=o("4d64").includes,s=o("44d2"),a=o("ae40"),c=a("indexOf",{ACCESSORS:!0,1:0});n({target:"Array",proto:!0,forced:!c},{includes:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),s("includes")},f4c2:function(e,t,o){"use strict";var n=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{key:"input-select-"+e.id,staticClass:"input-select",attrs:{id:"inputSelect"+e.id},on:{click:function(e){e.stopPropagation()}}},[o("van-field",{attrs:{name:e.name,label:e.label,placeholder:e.placeholder,rules:e.rules},on:{focus:function(t){return e.inputFocus()},blur:function(t){return e.inputBlur()}},model:{value:e.inputValue,callback:function(t){e.inputValue=t},expression:"inputValue"}}),o("div",{directives:[{name:"show",rawName:"v-show",value:e.showList,expression:"showList"}],staticClass:"list",style:"top"==e.listPosition?"bottom: "+e.inputSelectHeight+"px;":null},[o("ul",e._l(e.searchList,(function(t,n){return o("li",{key:"input-select-"+e.id+"-list-"+ +n,on:{click:function(t){return t.stopPropagation(),e.select(n)}}},[o("span",[e._v(e._s(e.listKey?t[e.listKey]:t))]),o("van-icon",{directives:[{name:"show",rawName:"v-show",value:1!=e.inputType,expression:"inputType != 1"}],attrs:{name:"cross"},on:{click:function(t){return t.stopPropagation(),e.del(n)}}})],1)})),0)])],1)},i=[],s=(o("4de4"),o("caad"),o("c975"),o("a9e3"),o("d3b7"),o("ac1f"),o("25f0"),o("841c"),{name:"InputSelect",components:{},props:{value:{type:String},inputType:{type:Number,default:0,validator:function(e){return[0,1].includes(e)}},search:{type:Boolean,default:!0},name:{type:String},label:{type:String},placeholder:{type:String},rules:{type:Array},list:{type:Array},listKey:String,bindKey:String,listPosition:{type:String,default:"bottom",validator:function(e){return["bottom","top"].includes(e)}}},data:function(){return{inputValue:"",showList:!1,showListEnable:!0,bindValue:"",inputSelectHeight:44,isSelect:!1}},computed:{id:function(){return this._uid},searchList:function(){var e=this;if(this.search){var t=this.list.filter((function(t){var o=e.listKey?t[e.listKey]:t;return!!o&&-1!=o.indexOf(e.inputValue)}));return t}return this.list}},watch:{value:function(e){!this.isSelect&&(this.inputValue=e),this.isSelect=!1},inputValue:function(e){this.$emit("input",this.bindKey?this.bindValue:e)}},methods:{inputFocus:function(){document.body.click(),this.setInputSelectHeight(),this.showList=!0},inputBlur:function(){1==this.inputType&&(this.inputValue="")},del:function(e){console.log("del",e),this.$emit("del",e)},select:function(e){this.setInputSelectHeight(),this.showList=!1,this.bindValue=this.bindKey?this.list[e][this.bindKey].toString():this.list[e],this.inputValue=this.listKey?this.list[e][this.listKey]:this.list[e],this.isSelect=!0},setInputSelectHeight:function(){var e=this;this.$nextTick().then((function(){setTimeout((function(){e.inputSelectHeight=document.getElementById("inputSelect"+e.id).clientHeight}),500)}))}},mounted:function(){var e=this;this.$nextTick((function(){document.body.addEventListener("click",(function(){e.showList=!1}))}))}}),a=s,c=(o("f895"),o("2877")),r=Object(c["a"])(a,n,i,!1,null,"0e9f72b4",null);t["a"]=r.exports},f895:function(e,t,o){"use strict";var n=o("11da"),i=o.n(n);i.a}}]);
//# sourceMappingURL=chunk-4faa81b8.88651a6c.js.map