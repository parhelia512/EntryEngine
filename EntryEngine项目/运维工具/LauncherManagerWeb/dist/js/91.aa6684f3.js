"use strict";(self["webpackChunkclient"]=self["webpackChunkclient"]||[]).push([[91],{825:function(e,t,s){s.d(t,{Z:function(){return d}});var i=s(3396),l=s(9242),n=s(7139);const u=["id"],o=["onClick"];function r(e,t,s,r,a,c){const h=(0,i.up)("van-field"),d=(0,i.up)("van-icon");return(0,i.wg)(),(0,i.iD)("div",{class:"input-select",id:"inputSelect"+c.id,key:"input-select-"+c.id,onClick:t[3]||(t[3]=(0,l.iM)((()=>{}),["stop"]))},[(0,i.Wm)(h,{modelValue:a.inputValue,"onUpdate:modelValue":t[0]||(t[0]=e=>a.inputValue=e),name:s.name,label:s.label,placeholder:s.placeholder,rules:s.rules,onFocus:t[1]||(t[1]=e=>c.inputFocus()),onBlur:t[2]||(t[2]=e=>c.inputBlur())},null,8,["modelValue","name","label","placeholder","rules"]),(0,i.wy)((0,i._)("div",{class:"list",style:(0,n.j5)("top"==s.listPosition?"bottom: "+a.inputSelectHeight+"px;":null)},[(0,i._)("ul",null,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(c.searchList,((e,t)=>((0,i.wg)(),(0,i.iD)("li",{key:"input-select-"+c.id+"-list-"+ +t,onClick:(0,l.iM)((e=>c.select(t)),["stop"])},[(0,i._)("span",null,(0,n.zw)(s.listKey?e[s.listKey]:e),1),(0,i.wy)((0,i.Wm)(d,{name:"cross",onClick:(0,l.iM)((e=>c.del(t)),["stop"])},null,8,["onClick"]),[[l.F8,1!=s.inputType]])],8,o)))),128))])],4),[[l.F8,a.showList]])],8,u)}var a={name:"InputSelect",components:{},props:{value:{type:String},inputType:{type:Number,default:0,validator:function(e){return[0,1].includes(e)}},search:{type:Boolean,default:!0},name:{type:String},label:{type:String},placeholder:{type:String},rules:{type:Array},list:{type:Array},listKey:String,bindKey:String,listPosition:{type:String,default:"bottom",validator:function(e){return["bottom","top"].includes(e)}}},data(){return{inputValue:"",showList:!1,showListEnable:!0,bindValue:"",inputSelectHeight:44,isSelect:!1}},computed:{id(){return this._uid},searchList(){if(this.search){let e=this.list.filter((e=>{const t=this.listKey?e[this.listKey]:e;return!!t&&-1!=t.indexOf(this.inputValue)}));return e}return this.list}},watch:{value:function(e){!this.isSelect&&(this.inputValue=e),this.isSelect=!1},inputValue:function(e){this.$emit("update:model-value",this.bindKey?this.bindValue:e)}},methods:{inputFocus(){document.body.click(),this.setInputSelectHeight(),this.showList=!0},inputBlur(){1==this.inputType&&(this.inputValue="")},del(e){console.log("del",e),this.$emit("del",e)},select(e){this.setInputSelectHeight(),this.showList=!1,this.bindValue=this.bindKey?this.list[e][this.bindKey].toString():this.list[e],this.inputValue=this.listKey?this.list[e][this.listKey]:this.list[e],this.isSelect=!0,this.$emit("onselect",this.bindKey?this.bindValue:this.inputValue)},setInputSelectHeight(){this.$nextTick().then((()=>{setTimeout((()=>{this.inputSelectHeight=document.getElementById("inputSelect"+this.id).clientHeight}),500)}))}},mounted(){this.$nextTick((()=>{document.body.addEventListener("click",(()=>{this.showList=!1}))}))}},c=s(89);const h=(0,c.Z)(a,[["render",r],["__scopeId","data-v-0fc48a88"]]);var d=h},2091:function(e,t,s){s.r(t),s.d(t,{default:function(){return p}});var i=s(3396);const l={class:"container"},n={style:{"margin-top":"30px",width:"100%"}},u=(0,i.Uk)(" 登录 ");function o(e,t,s,o,r,a){const c=(0,i.up)("van-nav-bar"),h=(0,i.up)("input-select"),d=(0,i.up)("van-field"),p=(0,i.up)("van-button"),m=(0,i.up)("van-form");return(0,i.wg)(),(0,i.iD)("div",l,[(0,i.Wm)(c,{title:"登录",style:{width:"100%"}}),(0,i.Wm)(m,{onSubmit:a.onSubmit,class:"form"},{default:(0,i.w5)((()=>[(0,i.Wm)(h,{modelValue:r.form.username,"onUpdate:modelValue":t[0]||(t[0]=e=>r.form.username=e),name:"username",label:"用户名",placeholder:"用户名",rules:[{required:!0,message:"请填写用户名"}],list:r.user,search:!1,onDel:t[1]||(t[1]=e=>a.userDel(e))},null,8,["modelValue","list"]),(0,i.Wm)(d,{modelValue:r.form.password,"onUpdate:modelValue":t[2]||(t[2]=e=>r.form.password=e),type:"password",name:"password",label:"密码",placeholder:"密码",rules:[{required:!0,message:"请填写密码"}]},null,8,["modelValue"]),(0,i.Wm)(h,{modelValue:r.form.serve,"onUpdate:modelValue":t[3]||(t[3]=e=>r.form.serve=e),name:"serve",label:"地址",placeholder:"服务器、端口",rules:[{required:!0,message:"请填写地址"}],list:r.services,search:!1,onDel:t[4]||(t[4]=e=>a.serveDel(e))},null,8,["modelValue","list"]),(0,i._)("div",n,[(0,i.Wm)(p,{round:"",block:"",type:"primary","native-type":"submit"},{default:(0,i.w5)((()=>[u])),_:1})])])),_:1},8,["onSubmit"])])}var r=s(825),a=s(4733),c={components:{InputSelect:r.Z},data(){return{form:{username:"",password:"",serve:""},services:[],user:[]}},methods:{onSubmit(e){console.log("submit",e),this.$IMBSProxy.url=`http://${e.serve}/`,this.$IMBSProxy.Connect(e.username,e.password,(t=>{console.log("----\x3e",t),this.$store.commit("login",{token:t,services:e.serve,username:e.username}),this.$router.push("/services"),localStorage.setItem("token",t)}))},userDel(e){console.log("userDel",e),a.Z.userDel(e),this.init()},serveDel(e){console.log("serveDel",e),this.services=a.Z.serviceDel(e),this.init()},init(){this.services=a.Z.serviceGet(),this.user=a.Z.userGet(),this.user.length&&(this.form.username=this.user[this.user.length-1]),this.services.length&&(this.form.serve=this.services[this.services.length-1]),console.log("init",this.form)}},mounted(){this.init()}},h=s(89);const d=(0,h.Z)(c,[["render",o],["__scopeId","data-v-33732607"]]);var p=d}}]);